{% extends 'blog_app/main.html' %}
{% load static %}
{% block content %}

<div class="col-lg-8">

  <!-- Title -->
  <!-- <img class="img-circle" src="{{ post.author.profile.image.url }}"> -->
  <!-- <h2 class="mt-4">{{ post.title }}</h2> -->
  <br>
  <img class="img-circle" src="{{ post.author.profile.image.url }}">
  <h4 class="card-title">{{ post.title }}</h4>

  <!-- Author -->
  <p class="lead">
    by
    <a href="{% url 'user-posts' post.author.username %}">{{ post.author }}</a>
  </p>

  <hr>

  <!-- Date/Time -->
  <p>Posted  {{ post.date_posted|timesince }} <i>ago</i></p>

  <hr>

  <!-- Preview Image -->
  <img class="card-img-top" src="{{post.imageURL}}" alt="Card image cap">

  <hr>

  <!-- Post Content -->
  <p class="lead">{{ post.content }}</p>
  <hr>
 <!-- Likes -->

 <!-- <h4> {{ total_likes }} Like{{ total_likes|pluralize }}   ||  {{ post.comments.count }} Comment{{ post.comments|pluralize }}</h4> -->
<!-- <hr/> -->


<div id="like-section">
  {% include 'blog_app/like_section.html' %}
</div>

<hr>

  {% if post.author == user %}
  <a href="{% url 'post-update' post.id %}" class="btn btn-info">Update</a>
  <a href="{% url 'post-delete' post.id %}" class="btn btn-danger">Delete</a>
  {% endif %}
  <hr>
  

  <!-- Comments Form -->
  {% if user.is_authenticated %}
  <div class="card my-4" >
    <h5 class="card-header">Leave a Comment:</h5>

    <div class="card-body">
      <!-- <form method="Post"> -->
      
        <!-- <div class="form-group"> -->
          <form method="POST">
            {% csrf_token %}
            {{ comment_form }}
          <!-- <form method="post" class="comment-form" action=".">
          <input class="form-control"name="name" placeholder="Enter your name"><br/>
          <textarea class="form-control" rows="3"></textarea> -->
          <br/>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        <!-- </div> -->
       
     
    </div>

  </div>
  {% else %}
  <h5>Please to comment <a href="{% url 'login' %}"> Login</a></h5>
  <hr>
  {% endif %}

 
  <!-- Single Comment -->

  
  {% if not post.comments.all %}
  <h5>No Comments yet....</h5>
  {% else %}

   {% for comment in comments %}

  <blockquote class="blockquote">
    <!-- <p class="mb-0"><small>{{ comment.body }}</small> </p>  -->
   <p class="mb-0"><small>{{ comment.body }}</small>  <button type="button" name="button" class="reply-btn btn btn-outline-dark btn-sm ml-2">Reply</button></p> 
    <footer class="blockquote-footer"><small>by <cite title="Source Title">{{ comment.user|capfirst }}</cite>  <i>{{ comment.date_added|timesince }} ago</i></small>
     
    </footer>
  </blockquote>

  <div class="replied-comments container mt-2"style="display:none;">

    {% for reply in comment.replies.all %}
    <blockquote class="blockquote">
      <p class="mb-0"><small>{{ reply.body }}</small></p>
      <footer class="blockquote-footer"><small>by <cite title="Source Title">{{ reply.user|capfirst }}</cite></small>
    </footer>
    </blockquote>
    {% endfor %}
  	
    <div class="form-group row">
      <form method="post" class="reply-form" action=".">
        {% csrf_token %}
        <input type="hidden" name="comment_id" value="{{ comment.id }}">
        {{ comment_form.as_p }}
        {% if request.user.is_authenticated %}
          <input type="submit" value="Submit" class="btn btn-outline-success">
        {% else %}
          <input type="submit" value="Submit" class="btn btn-outline-success" disabled>
        {% endif %}
      </form>
    </div>
  </div>



  
  
  <hr>
  {% endfor %}

  {% endif %}

</div>



        <!-- Sidebar Widgets Column -->
       
        <div class="col-md-4">

          <!-- Search Widget -->
          <div class="card my-4">
            <h5 class="card-header">Search</h5>
            <div class="card-body">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Search for...">
                <span class="input-group-btn">
                  <button class="btn btn-secondary" type="button">Go!</button>
                </span>
              </div>
            </div>
          </div>
      
          <!-- Categories Widget  Recents-->
          <div class="card my-4">
            <h5 class="card-header">Most Recents Posts</h5>
            <div class="card-body">
              <div class="row">
      
                <div class="col-lg-12">
                  <ul class="list-unstyled mb-0">
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                  </ul>
                </div>
         
      
               
      
      
              </div>
            </div>
          </div>
      
      
      
           <!-- Categories Widget  Viewed-->
           <div class="card my-4">
            <h5 class="card-header">Most Viewed Posts</h5>
            <div class="card-body">
              <div class="row">
      
                <div class="col-lg-12">
                  <ul class="list-unstyled mb-0">
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                    <li>
                      <a href="#">Web Design Most Recents Posts</a>
                    </li>
                  </ul>
                </div>
              
      
              </div>
            </div>
          </div>
      
              <!-- Categories Widget  Viewed-->
              <div class="card my-4">
                <h5 class="card-header">Most Active Users</h5>
                <div class="card-body">
                  <div class="row">
          
                    <div class="col-lg-12">
                      <ul class="list-unstyled mb-0">
                        <li>
                          <a href="#">Web Design Most Recents Posts</a>
                        </li>
                        <li>
                          <a href="#">Web Design Most Recents Posts</a>
                        </li>
                        <li>
                          <a href="#">Web Design Most Recents Posts</a>
                        </li>
                        <li>
                          <a href="#">Web Design Most Recents Posts</a>
                        </li>
                        <li>
                          <a href="#">Web Design Most Recents Posts</a>
                        </li>
                      </ul>
                    </div>
                  
          
                  </div>
                </div>
              </div>
      
          <!-- Side Widget -->
          <!-- <div class="card my-4">
            <h5 class="card-header">Side Widget</h5>
            <div class="card-body">
              You can put anything you want inside of these side widgets. They are easy to use, and feature the new Bootstrap 4 card containers!
            </div>
          </div> -->
      
        </div>

  {% endblock content %}
                  